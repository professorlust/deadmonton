!function(){var a=function(b,c,d){var e=a.resolve(b);if(null==e){d=d||b,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=a.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,a.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports};a.modules={},a.aliases={},a.resolve=function(b){"/"===b.charAt(0)&&(b=b.slice(1));for(var c=[b,b+".js",b+".json",b+"/index.js",b+"/index.json"],d=0;d<c.length;d++){var b=c[d];if(a.modules.hasOwnProperty(b))return b;if(a.aliases.hasOwnProperty(b))return a.aliases[b]}},a.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!=b[d]&&""!=b[d]&&c.push(b[d]);return a.concat(c).join("/")},a.register=function(b,c){a.modules[b]=c},a.alias=function(b,c){if(!a.modules.hasOwnProperty(b))throw new Error('Failed to alias "'+b+'", it does not exist');a.aliases[c]=b},a.relative=function(b){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}var d=a.normalize(b,".."),e=function(c){var d=e.resolve(c);return a(d,b,c)};return e.resolve=function(e){var f=e.charAt(0);if("/"==f)return e.slice(1);if("."==f)return a.normalize(d,e);var g=b.split("/"),h=c(g,"deps")+1;return h||(h=0),e=g.slice(0,h+1).join("/")+"/deps/"+e},e.exists=function(b){return a.modules.hasOwnProperty(e.resolve(b))},e};var b=this;b.require="undefined"!=typeof b.require?b.require:a,function(){b.require.register("deadmonton/src/config.js",function(a,b,c){c.exports={categories:{"Theft From Vehicle":{rgb:[255,237,160],active:!0},"Theft Of Vehicle":{rgb:[254,217,118],active:!0},"Theft Over $5000":{rgb:[254,217,118],active:!0},"Break and Enter":{rgb:[253,141,60],active:!0},Robbery:{rgb:[253,141,60],active:!0},Assault:{rgb:[227,26,28],active:!0},"Sexual Assaults":{rgb:[227,26,28],active:!0},Homicide:{rgb:[0,0,0],active:!0}},window:{width:$(window).width(),height:$(window).height()},center:[53.5501,-113.5049]}}),b.require.register("deadmonton/src/modules/mediator.js",function(a,b,c){c.exports=_.extend({},Backbone.Events)}),b.require.register("deadmonton/src/modules/view.js",function(a,b,c){var d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.views=[],this.autorender&&this.render()}return f(b,a),b.prototype.autorender=!1,b.prototype.render=function(){return this},b}(Backbone.View),c.exports=d}),b.require.register("deadmonton/src/templates/category.js",function(a,b,c){c.exports=function(a){a||(a={});var b,c=[],d=function(a){return a&&a.ecoSafe?a:"undefined"!=typeof a&&null!=a?f(a):""},e=a.safe,f=a.escape;return b=a.safe=function(a){if(a&&a.ecoSafe)return a;("undefined"==typeof a||null==a)&&(a="");var b=new String(a);return b.ecoSafe=!0,b},f||(f=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){c.push('<span class="circle" style="background:rgb('),c.push(d(this.rgb)),c.push(')"></span> '),c.push(d(this.name))}).call(this)}.call(a),a.safe=e,a.escape=f,c.join("")}}),b.require.register("deadmonton/src/templates/layout.js",function(a,b,c){c.exports=function(a){a||(a={});var b,c=[],d=a.safe,e=a.escape;return b=a.safe=function(a){if(a&&a.ecoSafe)return a;("undefined"==typeof a||null==a)&&(a="");var b=new String(a);return b.ecoSafe=!0,b},e||(e=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){c.push('<div id="map"></div>\n<canvas id="canvas"></canvas>\n\n<div id="controls" class="box">\n    <span class="icon replay"></span>\n    <span class="icon play"></span>\n    <span class="icon pause"></span>\n</div>\n<div id="date" class="box"></div>\n<ul id="categories" class="box"></ul>\n\n<div id="loading" class="box">Loading &hellip;</div>')}).call(this)}.call(a),a.safe=d,a.escape=e,c.join("")}}),b.require.register("deadmonton/src/views/app.js",function(a,b,c){var d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=b("../modules/view"),i=b("../modules/mediator"),g=b("./controls"),f=b("./categories"),e=b("./canvas"),d=function(a){function c(){c.__super__.constructor.apply(this,arguments),this.views=[],i.on("loaded",function(){return $(this.el).find("#loading").hide()},this),$.get("crime.json.lzma",function(a){return LZMA.decompress(a.split(","),function(a){var b;return b=JSON.parse(a),new e({collection:b}),i.trigger("loaded")})})}return k(c,a),c.prototype.el="body",c.prototype.autorender=!0,c.prototype.template=b("../templates/layout"),c.prototype.render=function(){return $(this.el).html(this.template()),new g,new f,this},c}(h),c.exports=d}),b.require.register("deadmonton/src/views/canvas.js",function(a,b,c){var d,e,f,g,h=function(a,b){return function(){return a.apply(b,arguments)}},i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=b("../config"),e=b("../modules/view"),g=b("../modules/mediator"),d=function(a){function b(){this.draw=h(this.draw,this),b.__super__.constructor.apply(this,arguments),this.reset(),this.ctx=document.getElementById("canvas").getContext("2d"),this.ctx.globalCompositeOperation="darker",$("#canvas").attr("width",f.window.width).attr("height",f.window.height),g.on("play",this.play,this),g.on("pause",this.pause,this),g.on("replay",this.reset,this),g.on("redraw",this.redraw,this)}return j(b,a),b.prototype.el="#map",b.prototype.autorender=!0,b.prototype.render=function(){var a,b,c,d=this;return $(this.el).css("width",""+f.window.width+"px").css("height",""+f.window.height+"px"),c=f.center,a=c[0],b=c[1],this.map=new L.Map("map",{center:new L.LatLng(a,b),zoom:12,zoomControl:!1}),L.tileLayer.provider("Stamen.Toner").addTo(this.map),this.map.on("movestart",function(){return g.trigger("pause"),d.clear()}),this.map.on("moveend",function(){var a,b,c,e,f;if(d.particles.length){for(e=d.particles,f=[],b=0,c=e.length;c>b;b++)a=e[b],a.point=d.position(a.l),f.push(d.draw(a));return f}})},b.prototype.position=function(a){return this.map.layerPointToContainerPoint(this.map.latLngToLayerPoint(a))},b.prototype.clear=function(){return this.ctx.clearRect(0,0,f.window.width,f.window.height)},b.prototype.draw=function(a){var b,c,d,e;return c=a.point,e=a.ttl,c.x<0||c.y<0||!f.categories[a.c].active?void 0:(d=.1*e*this.map.getZoom(),b=this.ctx.createRadialGradient(c.x,c.y,0,c.x,c.y,d),b.addColorStop(0,"white"),b.addColorStop(.8,"rgba("+a.color+",0.5)"),b.addColorStop(1,"black"),this.ctx.beginPath(),this.ctx.fillStyle=b,this.ctx.arc(c.x,c.y,d,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fill())},b.prototype.play=function(){var a,b=this;return this.playing=!0,a=$("#date"),this.i1=setInterval(function(){var c,d;if(b.now>b.end)return b.stop();for(a.html(b.now.format("ddd, Do MMMM YYYY")),c=!0;c&&b.index<b.collection.length;)b.now>=new Date((d=b.collection[b.index]).t)?(d.ttl=10,d.point=b.position(d.l),d.color=f.categories[d.c].rgb.join(","),b.particles.push(d),b.index+=1):c=!1;return b.now=b.now.add("d",1)},200),this.i2=setInterval(function(){var a,c,d,e,f;for(b.clear(),e=b.particles,f=[],c=0,d=e.length;d>c;c++)a=e[c],b.draw(a),a.ttl>3?f.push(a.ttl-=.1):f.push(void 0);return f},33)},b.prototype.pause=function(){return this.playing=!1,_.each([this.i1,this.i2],clearInterval)},b.prototype.stop=function(){return this.pause(),g.trigger("stop")},b.prototype.reset=function(){return this.pause(),this.now=moment(new Date(this.collection[0].t)),this.end=moment(new Date(this.collection[this.collection.length-1].t)),this.particles=[],this.index=0},b.prototype.redraw=function(){return this.playing?void 0:(this.clear(),_.each(this.particles,this.draw))},b}(e),c.exports=d}),b.require.register("deadmonton/src/views/categories.js",function(a,b,c){var d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=b("../modules/view"),g=b("../config"),e=b("./category"),d=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.el="#categories",b.prototype.autorender=!0,b.prototype.render=function(){var a,b,c,d;d=g.categories;for(b in d)a=d[b],this.views.push(c=new e({model:_.extend(a,{name:b})})),$(this.el).append(c.el);return this},b}(f),c.exports=d}),b.require.register("deadmonton/src/views/category.js",function(a,b,c){var d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=b("../modules/view"),g=b("../modules/mediator"),f=b("../config"),d=function(a){function c(){return h=c.__super__.constructor.apply(this,arguments)}return j(c,a),c.prototype.autorender=!0,c.prototype.tagName="li",c.prototype.template=b("../templates/category"),c.prototype.events={click:"onToggle"},c.prototype.render=function(){var a;return(a=$(this.el)).html(this.template(this.model)),this.model.active&&a.addClass("active"),this},c.prototype.onToggle=function(){return $(this.el).toggleClass("active"),this.model.active=!this.model.active,g.trigger("redraw")},c}(e),c.exports=d}),b.require.register("deadmonton/src/views/controls.js",function(a,b,c){var d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=b("../modules/view"),f=b("../modules/mediator"),d=function(a){function b(){b.__super__.constructor.apply(this,arguments),f.on("loaded",this.onReady,this),f.on("stop",this.onStop,this),f.on("pause",this.onPause,this)}return h(b,a),b.prototype.el="#controls",b.prototype.autorender=!0,b.prototype.events={"click .icon.play.active":"onPlay","click .icon.pause.active":"onPlay","click .icon.replay.active":"onReplay"},b.prototype.playing=!1,b.prototype.onPlay=function(){return $(this.el).find(".play, .pause").toggleClass("active"),this.playing=!this.playing,$(this.el).find(".replay").addClass("active"),f.trigger(["pause","play"][+this.playing])},b.prototype.onReplay=function(){return this.playing=!0,$(this.el).find(".play").removeClass("active"),$(this.el).find(".pause").addClass("active"),f.trigger("replay"),f.trigger("play")},b.prototype.onReady=function(){return $(this.el).find(".icon.play").addClass("active")},b.prototype.onStop=function(){return this.playing=!1,$(this.el).find(".icon.play, .icon.pause").removeClass("active"),$(this.el).find(".icon.replay").addClass("active")},b.prototype.onPause=function(){return this.playing?(this.playing=!1,$(this.el).find(".icon.play").addClass("active"),$(this.el).find(".icon.pause").removeClass("active")):void 0},b}(e),c.exports=d})}();var c=b.require("deadmonton/src/views/app.js");"undefined"!=typeof define&&define.amd?define("deadmonton",[],function(){return c}):"undefined"!=typeof module&&module.exports?module.exports=c:b.deadmonton=c,b.require.alias("deadmonton/src/views/app.js","deadmonton/index.js")}();