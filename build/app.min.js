!function(){function a(b,c,d){var e=a.resolve(b);if(null==e){d=d||b,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=a.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,a.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports}a.modules={},a.aliases={},a.resolve=function(b){"/"===b.charAt(0)&&(b=b.slice(1));for(var c=[b,b+".js",b+".json",b+"/index.js",b+"/index.json"],d=0;d<c.length;d++){var b=c[d];if(a.modules.hasOwnProperty(b))return b;if(a.aliases.hasOwnProperty(b))return a.aliases[b]}},a.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!=b[d]&&""!=b[d]&&c.push(b[d]);return a.concat(c).join("/")},a.register=function(b,c){a.modules[b]=c},a.alias=function(b,c){if(!a.modules.hasOwnProperty(b))throw new Error('Failed to alias "'+b+'", it does not exist');a.aliases[c]=b},a.relative=function(b){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function d(c){var e=d.resolve(c);return a(e,b,c)}var e=a.normalize(b,"..");return d.resolve=function(d){var f=d.charAt(0);if("/"==f)return d.slice(1);if("."==f)return a.normalize(e,d);var g=b.split("/"),h=c(g,"deps")+1;return h||(h=0),d=g.slice(0,h+1).join("/")+"/deps/"+d},d.exists=function(b){return a.modules.hasOwnProperty(d.resolve(b))},d},function(){a.register("deadmonton/src/app.js",function(a,b,c){var d;d=b("./views/layout"),c.exports=function(){return(new d).render()}}),a.register("deadmonton/src/config.js",function(a,b,c){c.exports={colors:{"Theft From Vehicle":[255,237,160],"Theft Of Vehicle":[254,217,118],"Theft Over $5000":[254,217,118],"Break and Enter":[253,141,60],Robbery:[253,141,60],Assault:[227,26,28],"Sexual Assaults":[227,26,28],Homicide:[0,0,0]},window:{width:$(window).width(),height:$(window).height()}}}),a.register("deadmonton/src/modules/mediator.js",function(a,b,c){c.exports=_.extend({},Backbone.Events)}),a.register("deadmonton/src/templates/controls.js",function(a,b,c){c.exports=function(a){a||(a={});var b,c=[],d=a.safe,e=a.escape;return b=a.safe=function(a){if(a&&a.ecoSafe)return a;("undefined"==typeof a||null==a)&&(a="");var b=new String(a);return b.ecoSafe=!0,b},e||(e=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){c.push('<span class="icon replay"></span>\n<span class="icon play"></span>\n<span class="icon pause"></span>')}).call(this)}.call(a),a.safe=d,a.escape=e,c.join("")}}),a.register("deadmonton/src/templates/layout.js",function(a,b,c){c.exports=function(a){a||(a={});var b,c=[],d=a.safe,e=a.escape;return b=a.safe=function(a){if(a&&a.ecoSafe)return a;("undefined"==typeof a||null==a)&&(a="");var b=new String(a);return b.ecoSafe=!0,b},e||(e=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){c.push('<div id="map"></div>\n<canvas id="canvas"></canvas>\n<div id="controls" class="box"></div>\n<div id="date" class="box"></div>\n<div id="loading" class="box">Loading &hellip;</div>')}).call(this)}.call(a),a.safe=d,a.escape=e,c.join("")}}),a.register("deadmonton/src/views/canvas.js",function(a,b,c){var d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=b("../config"),f=b("../modules/mediator"),d=function(a){function b(){var a;b.__super__.constructor.apply(this,arguments),this.reset(),a=document.getElementById("canvas"),this.ctx=a.getContext("2d"),$("#canvas").attr("width",e.window.width).attr("height",e.window.height),f.on("play",this.play,this),f.on("pause",this.pause,this),f.on("replay",this.reset,this)}return h(b,a),b.prototype.el="#map",b.prototype.render=function(){return $(this.el).css("width",""+e.window.width+"px").css("height",""+e.window.height+"px"),this.map=new L.Map("map",{center:new L.LatLng(53.5501,-113.5049),zoom:12,zoomControl:!1}),L.tileLayer.provider("Stamen.Toner").addTo(this.map)},b.prototype.play=function(){var a,b=this;return a=$("#date"),this.i1=setInterval(function(){var c,d;if(b.now>b.end)return b.stop();for(a.html(b.now.format("ddd, Do MMMM YYYY")),c=!0;c&&b.index<b.collection.length;)b.now>=new Date((d=b.collection[b.index]).t)?(d.ttl=10,d.point=b.map.latLngToLayerPoint(d.l),d.color=e.colors[d.c].join(","),b.particles.push(d),b.index+=1):c=!1;return b.now=b.now.add("d",1)},200),this.i2=setInterval(function(){var a,c,d,f,g,h,i,j,k;for(b.ctx.globalCompositeOperation="source-out",b.ctx.fillStyle="rgba(0,0,0,0.1)",b.ctx.fillRect(0,0,e.window.width,e.window.height),b.ctx.globalCompositeOperation="darker",j=b.particles,k=[],h=0,i=j.length;i>h;h++)d=j[h],f=d.point,a=d.color,g=d.ttl,c=b.ctx.createRadialGradient(f.x,f.y,0,f.x,f.y,g),c.addColorStop(0,"white"),c.addColorStop(.8,"rgba("+a+",0.5)"),c.addColorStop(1,"black"),b.ctx.beginPath(),b.ctx.fillStyle=c,b.ctx.arc(f.x,f.y,g,0,2*Math.PI,!1),b.ctx.closePath(),b.ctx.fill(),d.ttl>3?k.push(d.ttl-=.1):k.push(void 0);return k},33)},b.prototype.pause=function(){var a,b,c,d,e;for(d=[this.i1,this.i2],e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(clearInterval(a));return e},b.prototype.stop=function(){return this.pause(),this.particles=[],this.index=0,f.trigger("stop")},b.prototype.reset=function(){return this.pause(),this.now=moment(new Date(this.collection[0].t)),this.end=moment(new Date(this.collection[this.collection.length-1].t)),this.particles=[],this.index=0},b}(Backbone.View),c.exports=d}),a.register("deadmonton/src/views/controls.js",function(a,b,c){var d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=b("../modules/mediator"),d=function(a){function c(){c.__super__.constructor.apply(this,arguments),this.playing=!1,e.on("loaded",function(){return $(this.el).find(".icon.play").addClass("active")},this),e.on("stop",function(){return $(this.el).find(".icon.play").removeClass("active"),$(this.el).find(".icon.pause").removeClass("active"),$(this.el).find(".icon.replay").addClass("active")},this)}return g(c,a),c.prototype.el="#controls",c.prototype.template=b("../templates/controls"),c.prototype.events={"click .icon.play":"onPlay","click .icon.pause":"onPlay","click .icon.replay":"onReplay"},c.prototype.onPlay=function(a){return $(a.target).hasClass("active")?($(this.el).find(".play, .pause").toggleClass("active"),this.playing=!this.playing,e.trigger(["pause","play"][+this.playing]),$(this.el).find(".replay").addClass("active")):void 0},c.prototype.onReplay=function(a){var b;if((b=$(a.target)).hasClass("active"))return this.playing=!0,$(this.el).find(".play").removeClass("active"),$(this.el).find(".pause").addClass("active"),e.trigger("replay"),e.trigger("play")},c.prototype.render=function(){return $(this.el).html(this.template()),this},c}(Backbone.View),c.exports=d}),a.register("deadmonton/src/views/layout.js",function(a,b,c){var d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=b("./controls"),d=b("./canvas"),g=b("../modules/mediator"),f=function(a){function c(){c.__super__.constructor.apply(this,arguments),this.views=[],g.on("loaded",function(){return $(this.el).find("#loading").hide()},this),$.getJSON("data/crime.json",function(a){return new d({collection:a}).render(),g.trigger("loaded")})}return i(c,a),c.prototype.el="body",c.prototype.template=b("../templates/layout"),c.prototype.render=function(){return $(this.el).html(this.template()),(new e).render(),this},c}(Backbone.View),c.exports=f})}();var b=a("deadmonton/src/app.js"),c=this;"undefined"!=typeof define&&define.amd?define("deadmonton",[],function(){return b}):"undefined"!=typeof module&&module.exports?module.exports=b:c.deadmonton=b,a.alias("deadmonton/src/app.js","deadmonton/index.js"),c.require="undefined"!=typeof c.require?c.require:a}();